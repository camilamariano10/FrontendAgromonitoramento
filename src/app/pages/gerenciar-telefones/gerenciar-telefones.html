<section class="page-gerenciar-telefones">
  <article class="top-bar">
      <app-farm-header
        [nomeFazenda]="nomeFazenda"
        [ultimaAtualizacao]="ultimaAtualizacao">
      </app-farm-header>

    <button class="btn-adicionar" (click)="adicionarContato()">
      <i class="fa-solid fa-plus"></i> ADICIONAR CONTATO
    </button>
  </article>

  <main class="telefones-container">
    <!-- Cabeçalho -->
    <div class="telefones-header">
      <div class="titulo">
        <h2>Telefones Autorizados</h2>
        <p>Gerencie os números de WhatsApp autorizados a enviar análises</p>
      </div>

      <!-- Barra de Filtros -->
    <div class="filtros-barra">
      <div class="campo-busca-container">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input
          type="text"
          class="campo-busca"
          placeholder="Buscar por nome ou telefone..."
          [(ngModel)]="busca"
          (input)="aplicarFiltros()" />
      </div>

      <div class="dropdown-wrapper">
        <div class="filtro-status"
        [class.dropdown-open]="dropdownOpen"
        (click)="toggleStatusDropdown($event)">
          {{ filtroStatusLabel }}
          <i class="fa-solid fa-chevron-down"></i>
        </div>

        <ul class="filtro-status-opcoes" [class.show]="dropdownOpen">
          <li (click)="setFiltroStatus('todos')" class="opcao">Todos os status</li>
          <li (click)="setFiltroStatus('Ativo')" class="opcao">Ativo</li>
          <li (click)="setFiltroStatus('Inativo')" class="opcao">Inativo</li>
        </ul>
      </div>
    </div>

    </div>

    <!-- Linha divisória -->
    <div class="linha-divisoria"></div>

    <!-- Contador e Ordenação -->
    <div class="lista-header">
      <p class="contador">
        {{ funcionariosFiltrados.length }} telefone(s) encontrado(s)
      </p>
      <!-- Dropdown para Ordenar -->
      <div class="dropdown-wrapper">
        <span class="label-ordenar">Ordenar por:</span>
        
        <div class="ordenar-dropdown"
        [class.ordenar-open]="ordenarDropdownOpen"
        (click)="toggleOrdenarDropdown()">
          <span class="valor-selecionado">{{ ordenarLabel }}</span>
          <i class="fa-solid fa-chevron-down"></i>
        </div>
        <ul class="ordenar-opcoes" [class.show]="ordenarDropdownOpen">
          <li (click)="ordenarPor('nome')" class="opcao">Nome</li>
          <li (click)="ordenarPor('ultimoUso')" class="opcao">Último uso</li>
          <li (click)="ordenarPor('cargo')" class="opcao">Cargo</li>
        </ul>
      </div>
    </div>

    <!-- Lista de Contatos -->
    <div class="lista-funcionarios">
      <p *ngIf="funcionariosFiltrados.length === 0" class="vazio">
        Nenhum telefone encontrado.
      </p>

      <article class="card-funcionario" *ngFor="let f of funcionariosFiltrados">
        <div class="info">
          <i class="fa-brands fa-telegram icon"></i>
          <div class="dados">
            <h4>{{ f.nome }}</h4>
            <p>{{ f.telefone }}<br>
              <span class="cargo">{{ f.cargo }}</span>
              <span class="status-badge" [ngClass]="f.status === 'Ativo' ? 'ativo' : 'inativo'">
                {{ f.status }}
              </span>
            </p>
          </div>
        </div>

        <div class="acoes">
          <!-- Botão Toggle Ativar/Desativar -->
          <button class="btn-toggle" [class.ativo]="f.status === 'Ativo'" (click)="toggleStatus(f)">
            <i class="fa-solid" [ngClass]="f.status === 'Ativo' ? 'fa-toggle-on' : 'fa-toggle-off'"></i>
          </button>

          <!-- Editar -->
          <button class="btn-acao" (click)="editarContato(f)">
            <i class="fa-solid fa-pen"></i>
          </button>

          <!-- Excluir -->
          <button class="btn-acao excluir" (click)="excluirContato(f)">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </article>
    </div>
  </main>
</section>
